<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FleetFlow - Carrier Portal</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            font-size: 2.2em;
        }

        .nav-links {
            display: flex;
            gap: 15px;
        }

        .nav-link {
            background: rgba(255,255,255,0.2);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .nav-link:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }

        .content {
            padding: 40px;
        }

        .section {
            margin-bottom: 40px;
            border: 1px solid #e1e8ed;
            border-radius: 10px;
            overflow: hidden;
        }

        .section-header {
            background: #f8f9fa;
            padding: 20px;
            border-bottom: 1px solid #e1e8ed;
        }

        .section-header h2 {
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .section-content {
            padding: 25px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #2c3e50;
        }

        .form-input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }

        .btn-success {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        }

        .btn-danger {
            background: linear-gradient(135deg, #dc3545 0%, #e74c3c 100%);
        }

        .carrier-list {
            display: grid;
            gap: 20px;
        }

        .carrier-item {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            border-left: 4px solid #007bff;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }

        .carrier-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .carrier-item.valid {
            border-left-color: #28a745;
            background: #f8fff9;
        }

        .carrier-item.invalid {
            border-left-color: #dc3545;
            background: #fff8f8;
        }

        .carrier-item.pending {
            border-left-color: #ffc107;
            background: #fffdf5;
        }

        .carrier-info {
            flex-grow: 1;
        }

        .carrier-name {
            font-size: 1.2em;
            font-weight: 600;
            margin-bottom: 5px;
            color: #2c3e50;
        }

        .carrier-details {
            color: #6c757d;
            font-size: 0.9em;
        }

        .carrier-actions {
            display: flex;
            gap: 10px;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 600;
            text-transform: uppercase;
            margin-left: 10px;
        }

        .status-valid {
            background: #d4edda;
            color: #155724;
        }

        .status-invalid {
            background: #f8d7da;
            color: #721c24;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
        }

        .alert {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }

        .alert-success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }

        .alert-danger {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }

        .alert-warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
        }

        .validation-result {
            background: #f1f3f4;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            display: none;
        }

        .validation-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .detail-item {
            display: flex;
            flex-direction: column;
        }

        .detail-label {
            font-size: 0.85em;
            color: #6c757d;
            margin-bottom: 3px;
            font-weight: 600;
        }

        .detail-value {
            font-size: 0.95em;
            color: #2c3e50;
            font-weight: 500;
        }

        .quick-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-left: 4px solid #667eea;
        }

        .stat-number {
            font-size: 2em;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #6c757d;
            font-size: 0.9em;
        }

        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 15px;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .carrier-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }

            .carrier-actions {
                width: 100%;
                justify-content: flex-end;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üè¢ FleetFlow Carrier Portal</h1>
            <div class="nav-links">
                <a href="dispatch-central.html" class="nav-link">üìã Dispatch Central</a>
                <a href="carrier-validation-simple.html" class="nav-link">üìä Validation Demo</a>
                <a href="#" class="nav-link">‚öôÔ∏è Settings</a>
            </div>
        </div>

        <div class="content">
            <!-- Quick Stats -->
            <div class="quick-stats">
                <div class="stat-card">
                    <div class="stat-number" id="totalCarriers">3</div>
                    <div class="stat-label">Total Carriers</div>
                </div>
                <div class="stat-card" style="border-left-color: #28a745;">
                    <div class="stat-number" id="validCarriers">2</div>
                    <div class="stat-label">Valid Carriers</div>
                </div>
                <div class="stat-card" style="border-left-color: #dc3545;">
                    <div class="stat-number" id="invalidCarriers">1</div>
                    <div class="stat-label">Invalid Carriers</div>
                </div>
                <div class="stat-card" style="border-left-color: #17a2b8;">
                    <div class="stat-number" id="monitoringActive">2</div>
                    <div class="stat-label">Monitoring Active</div>
                </div>
            </div>

            <!-- Add New Carrier -->
            <div class="section">
                <div class="section-header">
                    <h2>‚ûï Add New Carrier</h2>
                    <p>Register a new carrier for FMCSA validation and BrokerSnapshot monitoring</p>
                </div>
                <div class="section-content">
                    <form id="carrierForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label" for="companyName">Company Name *</label>
                                <input type="text" id="companyName" class="form-input" placeholder="Enter company name" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="mcNumber">MC Number *</label>
                                <input type="text" id="mcNumber" class="form-input" placeholder="MC-123456" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label" for="dotNumber">DOT Number</label>
                                <input type="text" id="dotNumber" class="form-input" placeholder="DOT123456">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="contactEmail">Contact Email *</label>
                                <input type="email" id="contactEmail" class="form-input" placeholder="contact@carrier.com" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label" for="contactPhone">Contact Phone *</label>
                                <input type="tel" id="contactPhone" class="form-input" placeholder="(555) 123-4567" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="equipmentType">Equipment Type</label>
                                <select id="equipmentType" class="form-input">
                                    <option value="">Select Equipment Type</option>
                                    <option value="dry_van">Dry Van</option>
                                    <option value="reefer">Reefer</option>
                                    <option value="flatbed">Flatbed</option>
                                    <option value="step_deck">Step Deck</option>
                                    <option value="lowboy">Lowboy</option>
                                    <option value="tanker">Tanker</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="address">Business Address</label>
                            <input type="text" id="address" class="form-input" placeholder="123 Main St, City, State, ZIP">
                        </div>
                        
                        <div style="text-align: center; margin-top: 30px;">
                            <button type="submit" class="btn btn-success">üîç Add Carrier & Validate</button>
                            <button type="reset" class="btn">üîÑ Clear Form</button>
                        </div>
                    </form>

                    <!-- Validation Result Display -->
                    <div id="validationResult" class="validation-result"></div>
                </div>
            </div>

            <!-- Existing Carriers -->
            <div class="section">
                <div class="section-header">
                    <h2>üìã Carrier Management</h2>
                    <p>Manage existing carriers and their validation status</p>
                </div>
                <div class="section-content">
                    <div class="carrier-list" id="carrierList">
                        <!-- Carriers will be populated here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Sample carrier data
        const carriers = [
            {
                id: 1,
                companyName: 'Reliable Transport LLC',
                mcNumber: 'MC-123456',
                dotNumber: 'DOT123456',
                email: 'dispatch@reliabletransport.com',
                phone: '(555) 123-4567',
                equipmentType: 'dry_van',
                status: 'valid',
                validationScore: 95,
                fmcsaStatus: 'AUTHORIZED',
                safetyRating: 'SATISFACTORY',
                insuranceStatus: 'ACTIVE',
                creditScore: 750,
                riskLevel: 'low',
                monitoringEnabled: true,
                lastValidated: '2025-01-05 10:30 AM'
            },
            {
                id: 2,
                companyName: 'Problem Carrier Inc',
                mcNumber: 'MC-789012',
                dotNumber: 'DOT789012',
                email: 'office@problemcarrier.com',
                phone: '(555) 789-0123',
                equipmentType: 'reefer',
                status: 'invalid',
                validationScore: 25,
                fmcsaStatus: 'OUT OF SERVICE',
                safetyRating: 'UNSATISFACTORY',
                insuranceStatus: 'INACTIVE',
                creditScore: 450,
                riskLevel: 'high',
                monitoringEnabled: false,
                lastValidated: '2025-01-05 10:32 AM',
                errors: ['OUT OF SERVICE', 'Insurance Inactive', 'Poor Safety Rating']
            },
            {
                id: 3,
                companyName: 'Good Logistics Co',
                mcNumber: 'MC-345678',
                dotNumber: 'DOT345678',
                email: 'dispatch@goodlogistics.com',
                phone: '(555) 345-6789',
                equipmentType: 'flatbed',
                status: 'valid',
                validationScore: 80,
                fmcsaStatus: 'AUTHORIZED',
                safetyRating: 'SATISFACTORY',
                insuranceStatus: 'ACTIVE',
                creditScore: 680,
                riskLevel: 'medium',
                monitoringEnabled: true,
                lastValidated: '2025-01-05 10:35 AM'
            }
        ];

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            populateCarrierList();
            setupFormHandler();
        });

        function populateCarrierList() {
            const carrierList = document.getElementById('carrierList');
            carrierList.innerHTML = '';

            carriers.forEach(carrier => {
                const carrierElement = createCarrierElement(carrier);
                carrierList.appendChild(carrierElement);
            });
        }

        function createCarrierElement(carrier) {
            const div = document.createElement('div');
            div.className = `carrier-item ${carrier.status}`;
            
            const statusBadge = carrier.status === 'valid' ? 
                '<span class="status-badge status-valid">‚úÖ VALID</span>' :
                carrier.status === 'invalid' ?
                '<span class="status-badge status-invalid">‚ùå INVALID</span>' :
                '<span class="status-badge status-pending">‚è≥ PENDING</span>';

            div.innerHTML = `
                <div class="carrier-info">
                    <div class="carrier-name">
                        üè¢ ${carrier.companyName} ${statusBadge}
                    </div>
                    <div class="carrier-details">
                        ${carrier.mcNumber} | ${carrier.dotNumber || 'No DOT'} | ${carrier.equipmentType.replace('_', ' ').toUpperCase()} | 
                        Score: ${carrier.validationScore}% | Risk: ${carrier.riskLevel.toUpperCase()}
                        ${carrier.errors ? `<br><strong>Issues:</strong> ${carrier.errors.join(', ')}` : ''}
                    </div>
                </div>
                <div class="carrier-actions">
                    <button class="btn" onclick="viewCarrierDetails(${carrier.id})">üëÅÔ∏è View</button>
                    <button class="btn" onclick="revalidateCarrier(${carrier.id})">üîÑ Revalidate</button>
                    ${carrier.status === 'valid' ? 
                        '<button class="btn btn-success" onclick="assignLoad(' + carrier.id + ')">üì¶ Assign Load</button>' : 
                        '<button class="btn btn-danger" onclick="showBlockedMessage(' + carrier.id + ')">üö´ Blocked</button>'
                    }
                </div>
            `;

            return div;
        }

        function setupFormHandler() {
            const form = document.getElementById('carrierForm');
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                addNewCarrier();
            });
        }

        function addNewCarrier() {
            const formData = {
                companyName: document.getElementById('companyName').value,
                mcNumber: document.getElementById('mcNumber').value,
                dotNumber: document.getElementById('dotNumber').value,
                email: document.getElementById('contactEmail').value,
                phone: document.getElementById('contactPhone').value,
                equipmentType: document.getElementById('equipmentType').value,
                address: document.getElementById('address').value
            };

            // Show loading state
            showValidationResult('pending', 'Validating carrier...', null);

            // Simulate validation process
            setTimeout(() => {
                const validation = simulateValidation(formData.mcNumber);
                showValidationResult(validation.status, validation.message, validation.details);
                
                if (validation.status === 'success') {
                    // Add to carriers list
                    const newCarrier = {
                        id: carriers.length + 1,
                        ...formData,
                        status: validation.details.isValid ? 'valid' : 'invalid',
                        validationScore: validation.details.score,
                        fmcsaStatus: validation.details.fmcsaStatus,
                        safetyRating: validation.details.safetyRating,
                        insuranceStatus: validation.details.insuranceStatus,
                        creditScore: validation.details.creditScore,
                        riskLevel: validation.details.riskLevel,
                        monitoringEnabled: validation.details.isValid,
                        lastValidated: new Date().toLocaleString(),
                        errors: validation.details.errors || []
                    };
                    
                    carriers.push(newCarrier);
                    populateCarrierList();
                    updateStats();
                    
                    // Clear form
                    document.getElementById('carrierForm').reset();
                }
            }, 2000);
        }

        function simulateValidation(mcNumber) {
            // Simulate different validation outcomes based on MC number
            const lastDigit = mcNumber.slice(-1);
            
            if (['1', '3', '5', '7', '9'].includes(lastDigit)) {
                return {
                    status: 'success',
                    message: 'Carrier validation completed successfully!',
                    details: {
                        isValid: true,
                        score: 85,
                        fmcsaStatus: 'AUTHORIZED',
                        safetyRating: 'SATISFACTORY',
                        insuranceStatus: 'ACTIVE',
                        creditScore: 720,
                        riskLevel: 'low'
                    }
                };
            } else if (['2', '4', '6', '8'].includes(lastDigit)) {
                return {
                    status: 'success',
                    message: 'Carrier validation completed - Issues found!',
                    details: {
                        isValid: false,
                        score: 35,
                        fmcsaStatus: 'OUT OF SERVICE',
                        safetyRating: 'UNSATISFACTORY',
                        insuranceStatus: 'INACTIVE',
                        creditScore: 480,
                        riskLevel: 'high',
                        errors: ['OUT OF SERVICE', 'Insurance Inactive', 'Poor Safety Rating']
                    }
                };
            } else {
                return {
                    status: 'error',
                    message: 'Validation failed - Unable to connect to FMCSA database',
                    details: null
                };
            }
        }

        function showValidationResult(status, message, details) {
            const resultDiv = document.getElementById('validationResult');
            resultDiv.style.display = 'block';
            
            let alertClass = 'alert-warning';
            let icon = '‚è≥';
            
            if (status === 'success') {
                alertClass = details && details.isValid ? 'alert-success' : 'alert-danger';
                icon = details && details.isValid ? '‚úÖ' : '‚ùå';
            } else if (status === 'error') {
                alertClass = 'alert-danger';
                icon = '‚ùå';
            }

            let detailsHtml = '';
            if (details) {
                detailsHtml = `
                    <div class="validation-details">
                        <div class="detail-item">
                            <div class="detail-label">FMCSA Status</div>
                            <div class="detail-value">${details.fmcsaStatus}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Safety Rating</div>
                            <div class="detail-value">${details.safetyRating}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Insurance Status</div>
                            <div class="detail-value">${details.insuranceStatus}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Credit Score</div>
                            <div class="detail-value">${details.creditScore}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Risk Level</div>
                            <div class="detail-value">${details.riskLevel.toUpperCase()}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Validation Score</div>
                            <div class="detail-value">${details.score}%</div>
                        </div>
                    </div>
                `;
                
                if (details.errors && details.errors.length > 0) {
                    detailsHtml += `
                        <div class="alert alert-danger" style="margin-top: 15px;">
                            <strong>Validation Errors:</strong> ${details.errors.join(', ')}
                        </div>
                    `;
                }
            }

            resultDiv.innerHTML = `
                <div class="alert ${alertClass}">
                    <strong>${icon} ${message}</strong>
                </div>
                ${detailsHtml}
            `;
        }

        function updateStats() {
            const valid = carriers.filter(c => c.status === 'valid').length;
            const invalid = carriers.filter(c => c.status === 'invalid').length;
            const monitoring = carriers.filter(c => c.monitoringEnabled).length;
            
            document.getElementById('totalCarriers').textContent = carriers.length;
            document.getElementById('validCarriers').textContent = valid;
            document.getElementById('invalidCarriers').textContent = invalid;
            document.getElementById('monitoringActive').textContent = monitoring;
        }

        function viewCarrierDetails(carrierId) {
            const carrier = carriers.find(c => c.id === carrierId);
            if (carrier) {
                alert(`üè¢ ${carrier.companyName}\n\n` +
                      `MC: ${carrier.mcNumber}\n` +
                      `Status: ${carrier.status.toUpperCase()}\n` +
                      `FMCSA: ${carrier.fmcsaStatus}\n` +
                      `Safety: ${carrier.safetyRating}\n` +
                      `Insurance: ${carrier.insuranceStatus}\n` +
                      `Credit Score: ${carrier.creditScore}\n` +
                      `Risk Level: ${carrier.riskLevel.toUpperCase()}\n` +
                      `Monitoring: ${carrier.monitoringEnabled ? 'ENABLED' : 'DISABLED'}\n` +
                      `Last Validated: ${carrier.lastValidated}`);
            }
        }

        function revalidateCarrier(carrierId) {
            alert('üîÑ Revalidation triggered for carrier!\n\nThis will:\n‚Ä¢ Check latest FMCSA status\n‚Ä¢ Update BrokerSnapshot data\n‚Ä¢ Refresh monitoring alerts\n‚Ä¢ Send notification to dispatch team');
        }

        function assignLoad(carrierId) {
            const carrier = carriers.find(c => c.id === carrierId);
            if (carrier) {
                alert(`üì¶ Load Assignment Ready!\n\n` +
                      `Carrier: ${carrier.companyName}\n` +
                      `Status: VALIDATED ‚úÖ\n\n` +
                      `This will redirect to Dispatch Central\n` +
                      `to select and assign a load to this carrier.`);
            }
        }

        function showBlockedMessage(carrierId) {
            const carrier = carriers.find(c => c.id === carrierId);
            if (carrier) {
                alert(`üö´ Carrier Blocked from Load Assignment\n\n` +
                      `Carrier: ${carrier.companyName}\n` +
                      `Issues: ${carrier.errors ? carrier.errors.join(', ') : 'Validation failed'}\n\n` +
                      `This carrier cannot receive loads until\n` +
                      `validation issues are resolved.`);
            }
        }
    </script>
</body>
</html>
